Parameter tcWhere
lcWhere = ''
lcWhere = Iif(Empty(fltrAruanne.kond),' qry.rekv_id = ' + Str(gRekv), '')

TEXT TO lcWhere ADDITIVE TEXTMERGE noshow
	<<IIF(LEN(lcWhere) > 0, 'and', '')>> ( konto in ('103701','103950','103009','203900','200060') or left(ltrim(rtrim(konto)),3) = ('201'))
ENDTEXT
SET STEP on
l_konto = null
lError = oDb.readFromModel('aruanned\raamatupidamine\kontosaldoandmik', 'kontosaldoandmik_report', 'l_konto,fltrAruanne.asutusid, fltrAruanne.kpv2, gRekv', 'tmpReport', lcWhere)
If !lError
	Messagebox('Viga',0+16, 'Konto saldoandmik')
	Set Step On
	Select 0
	Return .F.
Endif


Select sum(r.saldo) as saldo, asutus_id;
	From tmpReport r;
	GROUP BY asutus_id;
	INTO Cursor tmpKaibed


Select r.saldo, a.nimetus as asutus, a.regkood, a.aadress   ;
	From tmpKaibed r;
	INNER JOIN comAsutusRemote a ON a.id = r.asutus_id;
	ORDER By a.nimetus, a.regkood ;
	INTO Cursor KaibeAsutusAndmik_report1
	
Use In tmpReport
USE IN tmpKaibed

Select kaibeAsutusandmik_report1
