Parameter cWhere
l_vast_isik = ''
l_grupp = ''

IF !EMPTY(fltrAruanne.asutusid)
	SELECT comAsutusRemote
	LOCATE FOR id = fltrAruanne.asutusid
	l_vast_isik = comAsutusRemote.nimetus
ENDIF

IF !EMPTY(fltrAruanne.grupp)
	SELECT comGruppAruanne
	LOCATE FOR id = fltrAruanne.grupp
	l_grupp = comGruppAruanne.nimetus

ENDIF


TEXT TO lcWhere TEXTMERGE noshow
	konto ilike '<<ALLTRIM(fltrAruanne.konto)>>%'
	and grupp ilike '%<<ALLTRIM(l_grupp)>>%'
	and vastisik ilike '%<<ALLTRIM(l_vast_isik)>>%'
ENDTEXT

SET STEP ON 

lError = oDb.readFromModel('aruanned\pv\pv_kaibearuanne', 'pv_kaibe_aruanne_report', 'fltrAruanne.kpv1,fltrAruanne.kpv2, gRekv', 'kaibearuanne_report1',lcWhere)
If !lError
	Messagebox('Viga',0+16, 'PV käibearuanne')
	Set Step On
	SELECT 0
	RETURN .f.
Endif

*!*	SELECT kood, nimetus, konto, grupp, soetmaks, soet_kpv as soetkpv, kulum, alg_kulum as algkulum,kulum + alg_kulum as kulumkokku,; 
*!*		jaak, mahakantud, parandus ;
*!*	from tmpReport ;
*!*	ORDER BY grupp, kood;
*!*	INTO CURSOR varadearuanne_report1

*!*	USE IN tmpReport

SELECT kaibearuanne_report1
