Parameter cWhere
If Isdigit(Alltrim(cWhere))
	cWhere = Val(Alltrim(cWhere))
Endif
tnId = cWhere

IF !USED('v_korder1')
	lError = oDb.readFromModel('raamatupidamine\sorder', 'row', 'tnId, guserid', 'v_korder1')
	lError = oDb.readFromModel('raamatupidamine\sorder', 'details', 'tnId, guserid', 'v_korder2')	
ENDIF

SELECT v_korder1.id, v_Korder1.number, v_Korder1.kpv, v_Korder1.nimi,  v_Korder1.aadress, v_Korder1.dokument, v_Korder1.alus, ;
	v_Korder2.nimetus,  v_Korder2.summa,  v_korder1.kassa AS aa, v_Korder1.kokku, ;
	v_Korder2.kood1,  v_Korder2.kood2, v_Korder2.kood3, v_Korder2.kood4, v_Korder2.kood5, ;
	v_Korder2.tunnus;
	FROM  v_korder1, v_korder2 ;
	ORDER BY v_korder2.nimetus ;
	INTO CURSOR sorder_report1


lError = oDb.readFromModel('raamatupidamine\journal', 'row', 'tnId, guserid', 'qryJournal')
lError = oDb.readFromModel('raamatupidamine\journal', 'details', 'tnId, guserid', 'qryJournal1')

	Create Cursor sorder_lausend (Id Int, lausend m)
	Append Blank
		Select qryJournal1
		SCAN
			TEXT TO lcString TEXTMERGE noshow
				D: <<allrim(qryJournal1.deebet)>> TP: <<alltrim(qryJournal1.lisa_d)>>  K: <<alltrim(qryJournal1.kreedit)>>  TP: <<alltrim(qryJournal1.lisa_k) 
			ENDTEXT
			TEXT TO lcString TEXTMERGE NOSHOW additive
				Summa  <<alltrim(Str (qryJournal1.Summa,12,2))>> Eel: <<alltrim(qryJournal1.kood5)>> 				
			endtext
			TEXT TO lcString TEXTMERGE NOSHOW additive
				TT: <<alltrim(qryJournal1.kood1)>>
				
			endtext
							
			Replace Id With qryJournal.Number,;
				sorder_lausend.lausend With lcString Additive In sorder_lausend
		Endscan
	Endif
	If Used ('qryJournal')
		Use In qryJournal
	Endif
	If Used ('qryJournal1')
		Use In qryJournal1
	Endif
Select sorder_report1
