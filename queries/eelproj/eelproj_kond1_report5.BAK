Parameter tcWhere
lcWhere = ''

TEXT TO lcWhere TEXTMERGE noshow
	(EMPTY(<<fltrAruanne.asutusid>>) or rekv_id = <<fltrAruanne.asutusid>>)
	and coalesce(tegev,'') like '<<ALLTRIM(fltrAruanne.kood1)>>%'
	and coalesce(artikkel,'') like '<<ALLTRIM(fltrAruanne.kood5)>>%'
ENDTEXT

lError = oDb.readFromModel('aruanned\eelarve\allikas_eelnou', 'allikas_eelnou', 'fltrAruanne.kpv2, gRekv, fltrAruanne.kond', 'tmpReport', lcWhere)
If !lError
	Messagebox('Viga',0+16, 'Eelarve täitmine')
	Set Step On
	Select 0
	Return .F.
Endif

SELECT * ;
	from tmpReport ;
	ORDER BY  parentAsutus, asutus, tegev, artikkel,  ; 
	INTO Cursor eelarve_report1


Use In tmpReport
Select eelarve_report1

