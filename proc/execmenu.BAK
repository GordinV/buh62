Parameters tnId, is_popup
Local lError
Select curMenuRemote
Locate For Id = tnId

If Found() And !Empty(curMenuRemote.Proc)

	If is_popup
		Hide Popup (Alltrim(curMenuRemote.Name))
	Endif
	lError =Execscript(curMenuRemote.Proc)
	If is_popup
		Deactivate Popup (Alltrim(curMenuRemote.Name))
		Release Popup (Alltrim(curMenuRemote.Name))
	Endif
Else
	Messagebox('Not found')
Endif
Return lError
